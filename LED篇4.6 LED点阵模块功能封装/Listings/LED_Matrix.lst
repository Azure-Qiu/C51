C51 COMPILER V9.60.7.0   LED_MATRIX                                                        02/14/2024 12:54:26 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE LED_MATRIX
OBJECT MODULE PLACED IN .\Objects\LED_Matrix.obj
COMPILER INVOKED BY: C:\Software\Keil\C51\BIN\C51.EXE LED_Matrix.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\L
                    -istings\LED_Matrix.lst) OBJECT(.\Objects\LED_Matrix.obj)

line level    source

   1          #include "LED_Matrix.h"
   2          /** 
   3           **  @brief    LEDÁÇπÈòµÂ∞ÅË£ÖÔºà74HC595ËäØÁâáÈ©±Âä®‰ª£Á†ÅÔºâ
   4           **  @author   QIU
   5           **  @data     2023.08.23
   6           **/
   7          
   8          /*-------------------------------------------------------------------*/
   9          
  10          // ÁîªÈù¢Â∏ßÔºà2022Âπ¥12Êúà30Êó•Ôºâ
  11          u8 code Animation_Array[] = {
  12                  0x61,0x83,0x85,0x89,0x71,0x00,0x7E,0x81,
  13                  0x81,0x7E,0x00,0x61,0x83,0x85,0x89,0x71,
  14                  0x00,0x61,0x83,0x85,0x89,0x71,0x00,0x44,
  15                  0xDC,0x54,0x7F,0x54,0x44,0x00,0x40,0xFF,
  16                  0x00,0x61,0x83,0x85,0x89,0x71,0x00,0x01,
  17                  0xFE,0xA8,0x82,0xFF,0x00,0x42,0x91,0x99,
  18                  0x66,0x00,0x7E,0x81,0x81,0x7E,0x00,0xFF,
  19                  0x91,0x91,0xFF,0x00,0x00,0x00,0x00,0x00,
  20                  0x00,0x00,0x00,};
  21          
  22          
  23          
  24          
  25          /**
  26           **  @brief   74HC595ËäØÁâáÔºà‰∏≤ËΩ¨Âπ∂ÔºâÈ©±Âä®‰ª£Á†Å
  27           **  @param   dat:8‰Ωç‰∏≤Ë°åÊï∞ÊçÆ
  28           **  @retval  Êó†
  29           **/
  30          void LED_control(u8 dat){
  31   1              u8 i;
  32   1              //Â∞Ü‰∏Ä‰∏™Â≠óËäÇÊãÜÂàÜÊàê‰∏≤Ë°åËæìÂÖ•
  33   1              for(i=0;i<8;i++){
  34   2                      SER = dat >> 7; //ÂÖàÂ∞ÜÊúÄÈ´ò‰ΩçÈÄÅÂÖ•SER‰∏≠
  35   2                      dat <<= 1; //Â∑¶Áßª1‰Ωç(ÂéªÊéâÊúÄÈ´ò‰Ωç)Êõ¥Êñ∞Êï∞ÊçÆ
  36   2                      SH = 0; //ÁªôÁßª‰ΩçÂØÑÂ≠òÂô®Êó∂Â∫èËÑâÂÜ≤
  37   2                      _nop_();
  38   2                      SH = 1; //Ê£ÄÊµãÂà∞‰∏äÂçáÊ≤øÊó∂Â∞ÜSERÊï∞ÊçÆËØªÂÖ•Áßª‰ΩçÂØÑÂ≠òÂô®‰∏≠
  39   2                      _nop_();
  40   2              }
  41   1              ST = 0; //ÂΩì‰∏Ä‰∏™Â≠óËäÇ‰º†ËæìÂÆåÊØïÔºåÊ≠§Êó∂Áßª‰ΩçÂØÑÂ≠òÂô®Â∑≤Êª°„ÄÇÁªôÂ≠òÂÇ®ÂØÑÂ≠òÂô®Êó∂Â∫èËÑâÂÜ≤
  42   1              _nop_();
  43   1              ST = 1;//Ê£ÄÊµãÂà∞‰∏äÂçáÊ≤øÊó∂Â∞ÜÁßª‰ΩçÂØÑÂ≠òÂô®‰∏≠ÁöÑ8‰ΩçÊï∞ÊçÆÂÖ®ÈÉ®ËØªÂÖ•Â≠òÂÇ®ÂØÑÂ≠òÂô®‰∏≠„ÄÇÈÄöËøáÂπ
             -∂Ë°åËæìÂá∫ÂºïËÑöÂèØ‰ª•Áõ¥Êé•Ê£ÄÊµãÂà∞
  44   1              _nop_();
  45   1      }
  46          
  47          
  48          
  49          /**
  50           **  @brief   Ê∏ÖÂ±èÂáΩÊï∞
  51           **  @param   Êó†
  52           **  @retval  Êó†
  53           **/
C51 COMPILER V9.60.7.0   LED_MATRIX                                                        02/14/2024 12:54:26 PAGE 2   

  54          void LED_Matrix_Init(){
  55   1              LED_Matrix_PORT = 0xff;
  56   1      }
  57          
  58          
  59          /**
  60           **  @brief   Âä®ÊÄÅÊòæÁ§∫ÂØπÂ∫îÈùôÊÄÅÁîªÈù¢Â∏ßÔºà8*8Ôºâ
  61           **  @param   datXÔºöÈò¥ÊûÅÔºådatY:Èò≥ÊûÅ
  62           **  @retval  Êó†
  63           **/
  64          void LED_Animation_Show(u8 datX, u8 datY){
  65   1              LED_Matrix_Init(); //Ê∂àÂΩ±
  66   1              LED_control(datY); //Èò≥ÊûÅÁ†Å
  67   1              LED_Matrix_PORT = ~(0x80>>datX);
  68   1      }
  69          
  70          
  71          /**
  72           **  @brief   ÊéßÂà∂ËøõÂÖ•‰∏ã‰∏ÄÂ∏ßÁîªÈù¢ÁöÑÊó∂Èó¥
  73           **  @param   Êó†
  74           **  @retval  Âä®ÁîªÊï∞ÁªÑÁ¥¢ÂºïÂÅèÁßªÂÄº
  75           **/
  76          u16 Next_LED_Index(){
  77   1              static u16 count; // countÁî®‰∫éËÆ∞ÂΩïËøõÂÖ•‰∏ã‰∏ÄÂ∏ßÁîªÈù¢ÁöÑÊó∂Èó¥
  78   1              static u16 j;    // j‰∏∫ÁîªÈù¢Â∏ßÁßªÂä®ÁöÑÂàóÊï∞
  79   1              
  80   1              count++;
  81   1              if(count > SPEED){
  82   2                      count = 0;
  83   2                      j += COL_NUM;
  84   2                      if(j > LEN) j = 0;
  85   2              }
  86   1              return j;
  87   1      }
  88          
  89          
  90          
  91          
  92          /**
  93           **  @brief   Âª∂Êó∂Ê≥ïÂà∑Êñ∞
  94           **  @param   ÂèÇÊï∞ËØ¥Êòé
  95           **  @retval  ËøîÂõûÂÄº
  96           **/
  97          void LED_Matrix_Flush_Delay(){
  98   1              u8 i; // ÂΩìÂâçÁÇπ‰∫ÆÁöÑÂàóÂè∑
  99   1              
 100   1              // Âä®ÊÄÅÊòæÁ§∫‰∏ÄÂ∏ßÁîªÈù¢
 101   1              for(i=0;i<8;i++){
 102   2                      LED_Animation_Show(i, Animation_Array[i + Next_LED_Index()]);
 103   2                      delay_10us(100);
 104   2              }
 105   1      }
 106          
 107          
 108          /**
 109           **  @brief   ÂÆöÊó∂Âô®Ê≥ïÂà∑Êñ∞
 110           **  @param   ÂèÇÊï∞ËØ¥Êòé
 111           **  @retval  ËøîÂõûÂÄº
 112           **/
 113          void LED_Matrix_Flush_Timer(){
 114   1              static u8 i;
 115   1              
C51 COMPILER V9.60.7.0   LED_MATRIX                                                        02/14/2024 12:54:26 PAGE 3   

 116   1              LED_Animation_Show(i, Animation_Array[i + Next_LED_Index()]);
 117   1              if(i >= 8) i = 0;
 118   1              else i++;
 119   1      }
 120          
 121          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    210    ----
   CONSTANT SIZE    =     67    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      5       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
