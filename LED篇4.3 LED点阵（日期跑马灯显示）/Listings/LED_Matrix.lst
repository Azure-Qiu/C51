C51 COMPILER V9.60.7.0   LED_MATRIX                                                        01/28/2024 20:36:40 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE LED_MATRIX
OBJECT MODULE PLACED IN .\Objects\LED_Matrix.obj
COMPILER INVOKED BY: C:\Software\Keil\C51\BIN\C51.EXE LED_Matrix.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\L
                    -istings\LED_Matrix.lst) OBJECT(.\Objects\LED_Matrix.obj)

line level    source

   1          #include "LED_Matrix.h"
   2          
   3          
   4          #define LED_PORT P0
   5          
   6          
   7          sbit SER = P3^4; //串行输入
   8          sbit ST = P3^5; //存储寄存器时钟引脚
   9          sbit SH = P3^6; //移位存储器时钟引脚
  10          
  11          /**
  12            *  @brief 串转并驱动代码
  13            *  @param dat:8位串行数据
  14            *  @retval 返回值：无
  15            */
  16          void LED_control(u8 dat){
  17   1              u8 i;
  18   1              //将一个字节拆分成串行输入
  19   1              for(i=0;i<8;i++){
  20   2                      SER = dat >> 7; //先将最高位送入SER中
  21   2                      dat <<= 1; //左移1位(去掉最高位)更新数据
  22   2                      SH = 0; //给移位寄存器时序脉冲
  23   2                      delay_10us(1);
  24   2                      SH = 1; //检测到上升沿时将SER数据读入移位寄存器中
  25   2                      delay_10us(1);
  26   2              }
  27   1              ST = 0; //当一个字节传输完毕，此时移位寄存器已满。给存储寄存器时序脉冲
  28   1              delay_10us(1);
  29   1              ST = 1;//检测到上升沿时将移位寄存器中的8位数据全部读入存储寄存器中。通过并行输出引脚可以直接检测到
  30   1              delay_10us(1);
  31   1      }
  32          
  33          
  34          void LED_Init(){
  35   1              LED_PORT = 0xff;
  36   1      }
  37          
  38          
  39          
  40          /**
  41            *  @brief 显示对应静态画面（8*8）
  42            *  @param datX：阴极，datY:阳极
  43            *  @retval
  44            */
  45          void LED_Animation_Show(u8 datX, u8 datY){
  46   1              LED_control(datY); //阳极码
  47   1              LED_PORT = ~(0x80>>datX);
  48   1              delay_10us(100);
  49   1              LED_Init(); //消影
  50   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    107    ----
C51 COMPILER V9.60.7.0   LED_MATRIX                                                        01/28/2024 20:36:40 PAGE 2   

   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
